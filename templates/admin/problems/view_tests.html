{% extends "admin/base_site.html" %}
{% block content %}

<h2>ğŸ“„ {{ problem.code }} â€“ {{ problem.title }}</h2>
<p><b>Tá»•ng sá»‘ test:</b> {{ testcases|length }}</p>
<hr>

<table class="table table-bordered table-hover">
<thead>
  <tr>
    <th>#</th>
    <th>Input</th>
    <th>Output</th>
    <th>XoÃ¡</th>
  </tr>
</thead>
<tbody>
{% for t in testcases %}
<tr id="row-{{ t.id }}">
  <td>{{ forloop.counter }}</td>

  <td>
    <details>
      <summary>ğŸ‘ Input (xem)</summary>
      <pre style="white-space:pre-wrap; font-size:13px; background:#f8f9fa; padding:8px; border-radius:6px;">
{{ t.input_data }}
      </pre>
    </details>
  </td>

  <td>
    <details>
      <summary>ğŸ“¤ Output (xem)</summary>
      <pre style="white-space:pre-wrap; font-size:13px; background:#f3fcf3; padding:8px; border-radius:6px;">
{{ t.expected_output }}
      </pre>
    </details>
  </td>

  <td>
    <button class="btn btn-danger btn-sm" onclick="deleteTest({{ t.id }})">ğŸ—‘ XoÃ¡</button>
  </td>
</tr>
{% empty %}
<tr><td colspan="4">âš ï¸ ChÆ°a cÃ³ test case nÃ o</td></tr>
{% endfor %}
</tbody>
</table>

<script>
function deleteTest(testId) {
  if (!confirm("Báº¡n cÃ³ cháº¯c muá»‘n xoÃ¡ test nÃ y?")) return;
  fetch(`/admin/problems/problem/{{ problem.id }}/delete_test/${testId}/`, {
    method: "POST",
    headers: {"X-CSRFToken": "{{ csrf_token }}"}
  })
  .then(res => res.json())
  .then(data => {
    if (data.status === "ok") {
      document.getElementById(`row-${testId}`).remove();
    } else {
      alert("âŒ Lá»—i: " + (data.message || "KhÃ´ng thá»ƒ xoÃ¡"));
    }
  })
  .catch(err => alert("âš ï¸ Lá»—i máº¡ng: " + err));
}
</script>

{% endblock %}
