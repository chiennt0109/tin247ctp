{% extends "admin/change_form.html" %}
{% load static %}

{% block content %}
<div class="container">
  {{ block.super }}

  {% if show_upload_button %}
  <hr>
  <h3>üì¶ Upload ZIP Test Cases</h3>
  <form action="{% url 'admin:upload_tests' original.id %}" method="post" enctype="multipart/form-data" style="margin-top: 1em;">
    {% csrf_token %}
    <p><input type="file" name="zip_file" accept=".zip" required></p>
    <button type="submit" class="default btn btn-success">‚¨ÜÔ∏è Upload v√† Import</button>
  </form>
  {% endif %}
</div>

<!-- ============================================================
üß© SimpleMDE Markdown Editor for Problem.statement
============================================================ -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
<script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  const textarea = document.querySelector("#id_statement");
  if (textarea) {
    const mde = new SimpleMDE({
      element: textarea,
      spellChecker: false,
      autosave: { enabled: true, delay: 1500, uniqueId: "problem_statement" },
      renderingConfig: {
        singleLineBreaks: false,
        codeSyntaxHighlighting: true
      },
      toolbar: [
        "bold", "italic", "heading", "|",
        "quote", "unordered-list", "ordered-list", "|",
        "link", "image", "table", "code", "|",
        "preview", "side-by-side", "fullscreen", "|",
        "guide"
      ],
      placeholder: "‚úèÔ∏è Nh·∫≠p n·ªôi dung b√†i to√°n b·∫±ng Markdown...\n\nV√≠ d·ª•:\n## Input\n## Output\n```cpp\nint main() {}\n```"
    });
  }
});
</script>

<style>
.container {
  max-width: 1000px;
}
.CodeMirror, .editor-toolbar {
  border-radius: 6px;
}
.editor-toolbar {
  background-color: #f8f9fa;
}
.editor-preview {
  background: #fff;
  padding: 1em;
  line-height: 1.6;
}
</style>
{% endblock %}
